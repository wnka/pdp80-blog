{{ if .Get "src" }}
  {{ $path := .Get "src" }}
  {{ $image := resources.Get $path }}
  {{ $image := $image.Fit "768x1024 q75" }}
  <figure class="{{ with .Get "position"}}{{ . }}{{ else -}} left {{- end }}" >
    <img src="{{ $image.RelPermalink }}" {{ with .Get "alt" }} alt="{{ . | plainify }}" {{ end }} {{ with .Get "style" }} style="{{ . | safeCSS }}" {{ end }} class="aspect-ratio: {{ $image.Width }} / {{ $image.Height }}" />
    {{ if .Get "caption" }}
      <figcaption class="{{ with .Get "captionPosition"}}{{ . }}{{ else -}} center {{- end }}" {{ with .Get "captionStyle" }} style="{{ . | safeCSS }}" {{ end }}>{{ .Get "caption" | safeHTML }}</figcaption>
    {{ end }}
  </figure>
{{ end }}
